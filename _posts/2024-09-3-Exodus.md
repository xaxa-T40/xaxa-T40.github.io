---
title: "Exodus"
# date: 2019-04-18T15:34:30-04:00
categories:
  - blog
tags:
  - ctf
  - hacktrace-ranges
  - retired-mechines
---

### Affected Endpoint ###
Scope
```
    host/url:10.1.2.143
    Description: Access using hacktrace vpn
```
working time: 2 september - 3 september 2024

### Description ###
Background Story: Sometimes, forgetting will bring catastrophic events. As Friedrich Nietzsche said "To forget one's purpose is the commonest form of stupidity."

Vulnerability: Sensitive Data Exposure via LDAP.

### Impact ###
Impact File Inclusion & Misuse of Linux Capabilities is:
- Mount Directories via nfs.
- Information Disclosure.
- Privilege Escalation.


### Step To Reproduce ###
The steps in finding  vulnerability are as follows:
- Information Gathering.
- Enumeration.
- Exploit.
- Privilege escalation.
- Reporting.

### PoC ###
#### Information Gathering ####
Just as usual, we start off with the Nmap scan:
```
nmap -sCV -p- 10.1.2.143--min-rate=1000 -oN nmap -Pn 10.1.2.140
```
![alt text](/assets/images/hacktrace/exodus/image1.png)
![alt text](/assets/images/hacktrace/exodus/image2.png)
There are six ports open and one close: 80(http), 111(rpcbind), 389 (ldap), 443 (https close), 2049 (nfs_acl), 9090(ssl/zeus-admin?), 10000(http), 20048 (mountd). try enumerating port 80 using dirsearch
```
dirsearch -u http://10.1.2.143 
```
![alt text](/assets/images/hacktrace/exodus/image3.png)
After scanning, it turns out that there is nothing interesting, let's take a look at the web view. 
![alt text](/assets/images/hacktrace/exodus/image4.png)
The web interface is also nothing interesting, which means the path to the exploit is not on port 80. Let's go to port 111, there is something interesting about the nfs service, let's try to enumerate on port 111 with the payload:
```
showmount -e 10.1.2.143 
```
![alt text](/assets/images/hacktrace/exodus/image5.png)
Now there is a removeonly directory that we can mount. Next exploit.
```
sudo mount -t nfs -o rw 10.1.2.143:/removeonly mount
```
If so, move to the mount directory, then see if there is a mount‚Äù. Here you can see that there are files that have not been extracted. 
![alt text](/assets/images/hacktrace/exodus/image6.png)
Then extract using ``` tar -xvjf db2bak.tar.bz2 -C /tmp ```, If it is successful, it will appear as shown below.
![alt text](/assets/images/hacktrace/exodus/image7.png)
Then move to the /tmp directory and see if there is a localhost-2023_03_23_13_55_58 folder, then succeed and move to that directory, then explore what is in that directory, I found an interesting file, id2entry.db.
![alt text](/assets/images/hacktrace/exodus/image8.png)
In the id2entry.db file there are several usernames and passwords that are encrypted, this is a wala step to dive deeper, I tried to decrypt the passwords one by one using base64 and then using hashcat for {SSHA512}.

Use with hashcat : ``` hashcat -m 1711 pass.hash /usr/share/wordlists/rockyou.txt ```
And this is the result after decrypting everything:
1.	elise : {SSHA512}apWdzsoM4gqKK1FtkxPCZOGmt5+SU9gUqPq6dQRWJpzkodm4q17qYg1Dk5oQ+FI5EidnEKOE2T0VOoAtGTntfTaLfY2jXAa0: ``` 1qazxsw23edc ```
2.	putra   : {SSHA512}00Ibr4T0kxsHIqD8hum+Lu6bI8GKTWotYO/kJjg0pH/cHde1EjIJWDUo49LVDQ7tghqIeweEWNbtSEffmgu2iXuvQO8VtllD: ```jellybean```
