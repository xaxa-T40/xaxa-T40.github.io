---
title: "Exodus"
# date: 2019-04-18T15:34:30-04:00
categories:
  - blog
tags:
  - ctf
  - hacktrace-ranges
  - retired-mechines
---

### Affected Endpoint ###
Scope
```
    host/url:10.1.2.143
    Description: Access using hacktrace vpn
```
working time: 2 september - 3 september 2024

### Description ###
Background Story: Sometimes, forgetting will bring catastrophic events. As Friedrich Nietzsche said "To forget one's purpose is the commonest form of stupidity."

Vulnerability: Sensitive Data Exposure via LDAP.

### Impact ###
Impact File Inclusion & Misuse of Linux Capabilities is:
- Mount Directories via nfs.
- Information Disclosure.
- Privilege Escalation.


### Step To Reproduce ###
The steps in finding  vulnerability are as follows:
- Information Gathering.
- Enumeration.
- Exploit.
- Privilege escalation.
- Reporting.

### PoC ###
#### Information Gathering ####
Just as usual, we start off with the Nmap scan:
```
nmap -sCV -p- 10.1.2.143--min-rate=1000 -oN nmap -Pn 10.1.2.140
```
![alt text](/assets/images/hacktrace/exodus/image1.png)
![alt text](/assets/images/hacktrace/exodus/image2.png)
There are six ports open and one close: 80(http), 111(rpcbind), 389 (ldap), 443 (https close), 2049 (nfs_acl), 9090(ssl/zeus-admin?), 10000(http), 20048 (mountd). try enumerating port 80 using dirsearch
```
dirsearch -u http://10.1.2.143 
```
![alt text](/assets/images/hacktrace/exodus/image3.png)
After scanning, it turns out that there is nothing interesting, let's take a look at the web view. 
![alt text](/assets/images/hacktrace/exodus/image4.png)
The web interface is also nothing interesting, which means the path to the exploit is not on port 80. Let's go to port 111, there is something interesting about the nfs service, let's try to enumerate on port 111 with the payload:
```
showmount -e 10.1.2.143 
```
![alt text](/assets/images/hacktrace/exodus/image5.png)
Now there is a removeonly directory that we can mount. Next exploit.
```
sudo mount -t nfs -o rw 10.1.2.143:/removeonly mount
```
If so, move to the mount directory, then see if there is a mount‚Äù. Here you can see that there are files that have not been extracted. 
![alt text](/assets/images/hacktrace/exodus/image6.png)
Then extract using ``` tar -xvjf db2bak.tar.bz2 -C /tmp ```, If it is successful, it will appear as shown below.
![alt text](/assets/images/hacktrace/exodus/image7.png)
Then move to the /tmp directory and see if there is a localhost-2023_03_23_13_55_58 folder, then succeed and move to that directory, then explore what is in that directory, I found an interesting file, id2entry.db.
![alt text](/assets/images/hacktrace/exodus/image8.png)
In the id2entry.db file there are several usernames and passwords that are encrypted, this is a wala step to dive deeper, I tried to decrypt the passwords one by one using base64 and then using hashcat for {SSHA512}.

Use with hashcat : ``` hashcat -m 1711 pass.hash /usr/share/wordlists/rockyou.txt ```
And this is the result after decrypting everything:
```
1.	elise : {SSHA512}apWdzsoM4gqKK1FtkxPCZOGmt5+SU9gUqPq6dQRWJpzkodm4q17qYg1Dk5oQ+FI5EidnEKOE2T0VOoAtGTntfTaLfY2jXAa0:  1qazxsw23edc 
```
```
2.	putra   : {SSHA512}00Ibr4T0kxsHIqD8hum+Lu6bI8GKTWotYO/kJjg0pH/cHde1EjIJWDUo49LVDQ7tghqIeweEWNbtSEffmgu2iXuvQO8VtllD: jellybean
```
```
3.	ashley  : {SSHA512}fhYowoEu3kInHd4oX8IMBvB5Sjo9u0w1HZQTocKLCgGgvJ5Y4GJHaXcWKOQZQ25oWfKNE2OF4KDxjHuhYTlYAttTuhO3mQEI:  mynameisashley 
```
```
4.	budi    : {SSHA512}othOZFDBcLowBq9BAU6N7oTJX57prRiHWAA6K9P93XEV7HxkX9zd9AWdGGa5hijudbnBs+HUtPV3oPXcEAN6l3rNN3z8CSeD: fuck_inside
```
```
5.	madison : {SSHA512}uh9h7Jcbq1yeCy6KDHv+HSS13kIAlLKRKycNoKWLonU3bnDr2SIgfaTiZfNx7LqNi6jcPpJwHzWIRu+lobHnVsLUOgmoY/37
```
```
6.	joni    : {PBKDF2-SHA512}10000$KPOgo4hjCAWr2CFnEocJW/RrbNbase64: invalid input
```
There are 6 users, and only 4 can decrypt their passwords, which is enough for credential entry.
Continue to port 9090 with the url: https://10.1.2.143:9090. And this is how the web looks like. 
![alt text](/assets/images/hacktrace/exodus/image9.png)
Try entering the user and pass that we have, here I tried son: jellybean, and can log in.
![alt text](/assets/images/hacktrace/exodus/image10.png)
I tried to learn what we can do on this web. Now we can access the terminal on this web. 
![alt text](/assets/images/hacktrace/exodus/image11.png)
And fortunately the user.txt file is in putra, now we try to increase our access rights so that we can become root, try to find out the user whose uid is in putra with /etc/passwd 
![alt text](/assets/images/hacktrace/exodus/image12.png)
Found, it turns out that Budi has uid = 1000, we try to access Budi with the cred we have, And can be a favor, The next step is to increase our access rights to root.
![alt text](/assets/images/hacktrace/exodus/image13.png)

### Privilage Escalation ###

1.	Try to see the hidden files in the budi directory : ```ls -la /home/budi```
2.	There are some hidden files. 
![alt text](/assets/images/hacktrace/exodus/image14.png)
3.	Can see .bash_hsitory file.
![alt text](/assets/images/hacktrace/exodus/image15.png)
This seems quite strange, but maybe it can lead us to root access, so what's the harm in trying.Pindah ke directory bin: cd /usr/bin
4.	Then ./time /bin/sh -p, and boom can get privilege access to root
![alt text](/assets/images/hacktrace/exodus/image15.png)
5.  Read Flag user and root.txt